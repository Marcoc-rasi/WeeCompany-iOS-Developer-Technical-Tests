# Países
Esta aplicación es una sofisticada aplicación de iOS diseñada para `buscar` y mostrar información detallada sobre los `países`. Aquí tienes una visión general profesional de su funcionalidad:

# Características Principales
- `Búsqueda de Países`: Los usuarios pueden buscar países por nombre a través de un `UISearchBar` integrado en la barra de navegación. La aplicación es compatible con versiones de iOS `11.0` y superiores con capacidades de búsqueda mejoradas, incluido un requisito de no capitalización para las entradas de búsqueda para mejorar la experiencia del usuario.
- `Búsquedas Recientes`: La aplicación mantiene un historial de búsquedas recientes, lo que permite a los usuarios revisitar rápidamente consultas anteriores. Esta característica mejora la usabilidad al reducir la necesidad de volver a escribir términos buscados con frecuencia.
- `Visualización de Detalles del País`: Tras una búsqueda exitosa, la aplicación presenta información detallada sobre el país, incluido su nombre común, nombre oficial, capital, moneda y bandera. Esta información se carga dinámicamente y se muestra en una interfaz fácil de usar.
- `Visualización Interactiva de la Bandera`: Los usuarios pueden interactuar con la imagen de la bandera del país para acceder a opciones adicionales, como ver la bandera en pantalla completa o abrirla en Safari para una inspección más detallada.
- `Navegación e Interacción del Usuario`: La aplicación emplea transiciones modales y segues para navegar entre diferentes vistas, incluida una vista de búsquedas recientes y un visor de imágenes en pantalla completa. Utiliza `UIAlertControllers` para proporcionar retroalimentación o acciones al usuario, como la opción de cancelar o proceder con ciertas operaciones.

# Aspectos Técnicos Destacados
- `Obtención Asincrónica de Datos`: La aplicación aprovecha el modelo de concurrencia de Swift para realizar solicitudes de red de forma asincrónica, obteniendo detalles de países e imágenes de banderas sin bloquear el hilo de la interfaz de usuario. Este enfoque garantiza una experiencia de usuario fluida y receptiva.
- `Manejo de Errores y Retroalimentación al Usuario`: Mediante el uso de bloques try-catch y `UIAlertControllers`, la aplicación maneja de manera sólida los errores (por ejemplo, fallas en la carga de imágenes o búsquedas sin resultados) e informa adecuadamente al usuario, manteniendo un alto nivel de usabilidad incluso cuando surgen problemas inesperados.
- `Diseño de IU Adaptativa`: La aplicación incluye consideraciones para diferentes tipos de dispositivos, como la implementación de controladores de presentación emergente para iPads para garantizar un diseño y patrones de interacción óptimos en todos los dispositivos iOS.
- `Organización y Modularidad del Código`: La funcionalidad está encapsulada dentro de métodos y extensiones bien definidos, siguiendo los principios de encapsulación y separación de preocupaciones. Esta modularidad facilita el mantenimiento del código y futuras mejoras.

# Arquitectura de la Aplicación

# Application Architecture

## Model
| Clase                      | Descripción                                                 |
|----------------------------|--------------------------------------------------------------|
| `Country.swift`            | La estructura `Country` representa el modelo de datos para la información de un país, diseñada para una fácil codificación y decodificación con el protocolo `Codable`. Incluye varias propiedades como `name`, `capital`, `currencies`, `flags` y `maps`. **Nombre**: La estructura anidada `Name` almacena tanto el nombre común como el oficial del país. **Moneda**: La estructura anidada `Currency` representa la información de la moneda de un país, incluyendo el nombre y un símbolo opcional. **Banderas**: La estructura anidada `Flags` contiene URLs de las imágenes de la bandera del país, centrándose en el formato PNG. **Mapas**: La estructura `Maps` contiene URLs a varios servicios de mapas, actualmente solo almacenando la URL de Google Maps. Está diseñada para una posible expansión para incluir más URLs de servicios de mapas en el futuro. A través del cumplimiento del protocolo `Codable`, `Country` facilita la conversión sencilla entre formatos de objeto y datos, permitiendo un manejo fluido de datos de red o almacenamiento de datos local. |
| `CountrySearch.swift`      | La clase `CountrySearch` es un modelo diseñado para almacenar información relacionada con una operación de búsqueda de país. Implementa el protocolo `Codable` para permitir una codificación y decodificación fácil desde y hacia formatos de datos como JSON, lo que lo hace adecuado para almacenamiento local o transmisión en red. Esta clase contiene una propiedad `countryNameSearched` que almacena el nombre del país buscado, facilitando la visualización de búsquedas recientes y la repetición de búsquedas sin necesidad de volver a escribir el nombre del país. |
| `RecentSearchStorage.swift`| La clase `RecentSearchStorage` actúa como una utilidad para gestionar búsquedas recientes de países, utilizando archivos de lista de propiedades (plist) para el almacenamiento y el protocolo `Codable` para la codificación y decodificación de objetos. Genera dinámicamente una URL para el archivo plist dentro del directorio de documentos de la aplicación. Esta clase proporciona métodos tanto para guardar como para cargar búsquedas recientes.  **Guardado de Búsquedas Recientes**: El método `saveRecentSearches` codifica una matriz de objetos `CountrySearch` en un formato plist y lo escribe en la ubicación especificada. En caso de cualquier error durante este proceso, proporciona mensajes de error informativos para depuración.  **Carga de Búsquedas Recientes**: El método `loadRecentSearches` recupera una matriz de objetos `CountrySearch` del archivo plist. Si el archivo no existe o la decodificación encuentra un error, devuelve elegantemente una matriz vacía.  A través de estas funcionalidades, `RecentSearchStorage` asegura una gestión eficiente y persistencia de búsquedas recientes, contribuyendo a una mayor usabilidad e integridad de datos dentro de la aplicación. |

## View
| Clase                      | Descripción                                                  |
|----------------------------|--------------------------------------------------------------|
| `AllCountriesTableViewCell`| La clase `AllCountriesTableViewCell` está diseñada específicamente para presentar información detallada sobre un país dentro de una celda de vista de tabla. Cuenta con conexiones para varios componentes de IU, como etiquetas y una vista de imagen, para mostrar eficazmente los datos del país. El método `awakeFromNib()` realiza cualquier configuración adicional después de cargar la vista, típicamente desde un archivo nib. El método `setSelected(_:animated:)` configura la vista para el estado seleccionado, si es necesario. El método `update(with:image:)` actualiza las vistas de la celda con datos de un país específico, incluida su imagen de bandera. Toma un objeto `Country` y la imagen de la bandera como parámetros. El método `updateBad()` configura la celda para indicar que la información sobre el país no está disponible, típicamente llamado cuando hay un error al obtener datos del país o cuando faltan datos. A través de estos métodos, `AllCountriesTableViewCell` facilita la presentación de información sobre países dentro de una vista de tabla, asegurando una experiencia de usuario fluida e informativa. |

## Controller
| Clase                                 | Descrición                                                 |
|---------------------------------------|--------------------------------------------------------------|
| `AllCountriesTableViewController.swift` | La clase `AllCountriesTableViewController` gestiona la visualización de países y su información en una vista de tabla. Obtiene datos de países, incluidas las imágenes, y actualiza la interfaz de usuario en consecuencia.  En el método `viewDidLoad()`, el controlador comienza a monitorear cambios en la red y carga datos iniciales utilizando el método `loadData()`.  El método `loadData()` obtiene datos de países e imágenes de forma asincrónica, actualizando la interfaz de usuario con los datos obtenidos o mostrando un mensaje de error si la obtención de datos falla.  El método `updateUI(with:)` actualiza la interfaz de usuario de la vista de tabla con los datos de países obtenidos, recargando la vista de tabla para mostrar los nuevos datos.  El método `showAlert(title:message:)` muestra una alerta con un título y un mensaje especificados.  En el método `tableView(_:cellForRowAt:)`, el controlador configura las celdas según si hay datos disponibles o no. Si no hay datos disponibles, configura la celda para mostrar información predeterminada no disponible.  El método `tableView(_:willSelectRowAt:)` permite la selección de filas solo si hay una conexión a Internet y los datos no se están cargando.  En el método `prepare(for:sender:)`, el controlador se prepara para la transición a `DetailCountryViewController`, pasando el país seleccionado y su imagen si hay una conexión a Internet y los datos no se están cargando.  El método `observeNetworkChanges()` configura un manejador de cambios en el estado de la red para responder a cambios en la conectividad, actualizando la interfaz de usuario e intentando volver a cargar datos cuando cambia el estado de la conexión. |
| `DetailCountryViewController.swift`      | La clase `DetailCountryViewController` es responsable de mostrar información detallada sobre un país seleccionado. Muestra varios atributos como los nombres común y oficial del país, capital, moneda e imagen. Además, proporciona un botón para ver la ubicación del país en Google Maps.  En los métodos `viewDidLoad()` y `viewWillAppear(_:)`, los componentes de la interfaz de usuario se configuran con la información del país, asegurando que las etiquetas se actualicen y que la vista de imagen muestre la imagen del país o un marcador de posición si no está disponible.  El método `setupUI()` actualiza los elementos de la interfaz de usuario con la información del país, gestionando los casos en los que los datos puedan estar ausentes. Rellena las etiquetas con el nombre, capital y detalles de la moneda del país. Si hay disponible una imagen de la bandera del país, ajusta la vista de imagen en consecuencia; de lo contrario, utiliza una imagen de marcador de posición predeterminada.  El método `mapsButtonTapped(_:)` se activa cuando se presiona el botón de mapas. Intenta abrir la ubicación del país en Google Maps utilizando la URL de Google Maps del país.  El método `imageTapped(_:)` se invoca cuando se toca la imagen. Presenta una hoja de acciones que ofrece opciones relacionadas con la imagen del país, como abrir la imagen en Safari o verla a pantalla completa dentro de la aplicación.  El método `prepare(for:sender:)` se prepara para el segue hacia `FullscreenImageViewController`, pasando la imagen del país para que se muestre en modo de pantalla completa. |
| `FindCountriesByNameViewController.swift` | La clase `FindCountriesByNameViewController` gestiona la búsqueda y visualización de información de países dentro de un UIViewController personalizado. Contiene salidas para elementos de interfaz de usuario para presentar detalles del país e interacciones como la visualización de mapas. La clase incluye propiedades para almacenar los detalles del país encontrado y el historial de búsqueda reciente.  En `viewDidLoad()`, se cargan las búsquedas recientes y se configura un UISearchBar, ya sea programáticamente o a través del navigationItem según la versión de iOS. El método `configureInitialState()` establece el estado visual inicial de la interfaz de usuario.  El método `searchBarSearchButtonClicked(_:)` maneja los clics en el botón de búsqueda, iniciando una búsqueda con el texto proporcionado. El método `performSearch(with:)` busca de forma asíncrona los detalles del país según el texto de búsqueda y actualiza la interfaz de usuario en consecuencia, manejando errores y guardando búsquedas recientes.  El método `updateUI(with:)` actualiza la interfaz de usuario con los detalles del país encontrado, incluyendo su imagen. El método `loadCountryImage(_:)` carga y muestra de forma asíncrona la imagen de la bandera del país desde una URL.  El método `imageViewTapped(_:)` maneja los gestos de toque en la imagen de la bandera del país, presentando una hoja de acciones con opciones para ver la imagen en Safari o a pantalla completa. El método `prepare(for:sender:)` se prepara para segues, pasando datos a los controladores de vista de destino.  El método `showNoResultsAlert()` muestra una alerta si no se encuentran resultados de búsqueda. El método `recentsBarButtonTapped(_:)` desencadena una transición modal al controlador de vista de Búsquedas Recientes cuando se toca un botón de barra. La extensión `RecentSearchesDelegate` maneja las selecciones de la lista de búsquedas recientes, realizando una búsqueda utilizando el término de búsqueda reciente seleccionado. |
| `FullscreenImageViewController.swift`    | La clase `FullscreenImageViewController` está diseñada para presentar una imagen en modo de pantalla completa, permitiendo a los usuarios verla sin distorsión. Contiene una salida para un image view para mostrar la imagen.  En `viewDidLoad()`, la imagen pasada se asigna al image view y su modo de contenido se establece en `scaleAspectFit` para garantizar un escalado proporcional sin distorsión. Esta configuración asegura que la imagen se ajuste dentro de los límites de la vista sin estirarse ni aplastarse, proporcionando una experiencia de visualización a pantalla completa fluida. |
| `RecentSearchesTableViewController.swift` | La clase `RecentSearchesTableViewController` gestiona la visualización e interacción de una lista que muestra consultas de búsqueda de países recientes. Incluye una matriz `recentSearches` para almacenar los nombres de las búsquedas recientes y un `delegate` para manejar las acciones de selección en las búsquedas recientes, cumpliendo con `RecentSearchesDelegate` para comunicar eventos de selección de nuevo al controlador de vista delegado.  En `viewDidLoad()`, las búsquedas recientes se cargan desde el almacenamiento, y si no existen, se presenta un mensaje predeterminado. El método `loadRecentSearches()` carga las búsquedas recientes desde el almacenamiento persistente y las asigna a una matriz de cadenas para su visualización.  Los métodos de origen de datos de la vista de tabla (`tableView(_:numberOfRowsInSection:)` y `tableView(_:cellForRowAt:)`) están implementados para determinar el número de filas necesarias en la vista de tabla y para configurar cada celda con la cadena de búsqueda reciente correspondiente.  El método de delegado de la vista de tabla `tableView(_:didSelectRowAt:)` maneja la selección de una búsqueda reciente, informando al delegado de la búsqueda seleccionada y descartando el controlador de vista después de que se realiza una selección, suponiendo que este controlador de vista se presenta de forma modal.  A través de estos métodos, `RecentSearchesTableViewController` proporciona una interfaz de usuario amigable para ver y seleccionar consultas de búsqueda de países recientes. |

## Network
| Clase                     | Descripción                                                  |
|---------------------------|--------------------------------------------------------------|
| `ApiRequest.swift`        | La clase `APIRequestController` sirve como un componente crucial responsable de gestionar las solicitudes de red para recuperar información de países y sus imágenes de banderas correspondientes. Encapsula varios métodos asíncronos diseñados para interactuar con APIs externas y manejar graciosamente posibles errores que puedan surgir durante el proceso de obtención de datos.  En su núcleo, `APIRequestController` define el enum `CountryInfoError`, que describe los posibles errores que podrían ocurrir durante la recuperación de datos. Estos errores incluyen `itemNotFound`, que indica que el elemento solicitado no se encontró, y `imageDataMissing`, que significa que faltan o están dañados los datos de imagen de la bandera de un país.  La clase ofrece tres métodos asíncronos principales:  - El método `fetchCountryInfo()` recupera de forma asíncrona la lista completa de países desde un punto final de API especificado. Emplea `URLSession` para realizar la solicitud de red y decodifica la respuesta JSON en una matriz de objetos `Country`. En caso de fallo en la recuperación de datos, arroja un error `CountryInfoError.itemNotFound`.  - El método `fetchFlagImage(from url: URL)`, dado un URL que apunta a una imagen de bandera, recupera de forma asíncrona los datos de imagen utilizando `URLSession`. Asegura que el código de estado de respuesta HTTP sea 200 (indicando éxito) e intenta crear un `UIImage` a partir de los datos recibidos. Si ocurren errores durante el proceso, como falla al recuperar o decodificar los datos de imagen, arroja un error `CountryInfoError.imageDataMissing`.  - El método `fetchInfoAndImages()` combina las funcionalidades de `fetchCountryInfo()` y `fetchFlagImage(from:)`. Recupera de forma asíncrona la información del país usando `fetchCountryInfo()` y luego itera sobre cada país para recuperar su imagen de bandera correspondiente usando `fetchFlagImage(from:)`. El método devuelve una matriz de tuplas, cada una conteniendo un objeto `Country` y un `UIImage` opcional de la bandera. Cualquier error encontrado durante el proceso se propaga hacia arriba en la pila de llamadas.  Además, `APIRequestController` proporciona un método llamado `fetchCountryByName(_ name: String)`, facilitando la recuperación de información del país por nombre. Construye el URL para la solicitud de API, maneja la codificación de URL y decodifica la respuesta JSON en una matriz de objetos `Country`. En caso de errores, como una URL mal formada o un código de estado de respuesta HTTP no 200, se arrojan instancias apropiadas de `URLError`. |
| `NetworkMonitor.swift`    | El `AllCountriesTableViewController` es una clase que gestiona la visualización de países y su información en una tabla. Recupera datos de países, incluidas imágenes, y actualiza la interfaz de usuario en consecuencia. En el método `viewDidLoad()`, el controlador comienza a monitorear cambios en la red y carga datos iniciales utilizando `loadData()`. Este método recupera datos de países e imágenes de forma asíncrona, actualizando la interfaz de usuario con los datos recuperados o mostrando un mensaje de error si la obtención de datos falla. El método `updateUI(with:)` actualiza la interfaz de usuario de la tabla con los datos de países recuperados, recargando la tabla para mostrar los nuevos datos. El método `showAlert(title:message:)` muestra una alerta con un título y un mensaje especificados. En `tableView(_:cellForRowAt:)`, el controlador configura las celdas según si hay datos disponibles o no. Si no hay datos disponibles, configura la celda para mostrar información no disponible por defecto. `tableView(_:willSelectRowAt:)` permite la selección de filas solo si hay una conexión a internet y no se están cargando datos. En el método `prepare(for:sender:)`, el controlador se prepara para la transición a `DetailCountryViewController`, pasando el país seleccionado y su imagen si hay una conexión a internet y no se están cargando datos. El método `observeNetworkChanges()` establece un manejador de cambios de estado de red para responder a cambios de conectividad, actualizando la interfaz de usuario e intentando volver a cargar datos cuando cambia el estado de la conexión. |

## Protocol
| Clase                            | Descripción                                                  |
|----------------------------------|--------------------------------------------------------------|
| `RecentSearchesProtocol.swift`   | El protocolo `RecentSearchesDelegate` define una interfaz estándar para manejar eventos de selección desde una lista de búsquedas recientes. Las clases que adoptan este protocolo deben implementar el método `didSelectRecentSearch(_:)`, que se llama cuando se selecciona una búsqueda reciente. El método toma una cadena de consulta de búsqueda como parámetro, representando la consulta de búsqueda seleccionada. Este protocolo permite el desacoplamiento entre la interfaz de usuario y la lógica para manejar las selecciones de búsqueda recientes, promoviendo la modularidad y flexibilidad en el diseño. |


